{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/beamr/frontend/youtube-clone-frontend/src/Watch.js\";\nimport React, { Component } from \"react\";\nimport InfiniteScroll from 'react-infinite-scroll-component';\nimport './watch.scss';\nimport { abbreviate_number } from './helpers';\nimport VideoPreview from \"./VideoPreview\";\n\nclass Watch extends Component {\n  constructor(props) {\n    super(props);\n\n    this.fetchMoreData = () => {\n      fetch(\"/upnext_videos?start=0&num=5\", {}).then(response => response.json()).then(data => {\n        this.setState({\n          items: this.state.items.concat(data[\"videos\"])\n        });\n      });\n    };\n\n    const urlParams = new URLSearchParams(props.location.search);\n    this.state = {\n      'manifest_url': \"\",\n      'title': \"\",\n      'channel': \"\",\n      \"channel_url\": \"\",\n      \"channel_icon_url\": \"\",\n      \"view_count\": \"\",\n      \"upload_date\": \"\",\n      \"subscriber_count\": \"\",\n      \"description\": \"\",\n      items: [],\n      comments: [],\n      hasMore: false,\n      commentValue: \"\",\n      video_id: urlParams.get('id')\n    };\n    this.new_page(props);\n    this.handleCommentSubmit = this.handleCommentSubmit.bind(this);\n    this.handleCommentChange = this.handleCommentChange.bind(this);\n  }\n\n  componentDidMount() {\n    var submit_comment = document.getElementById(\"submit-comment\");\n\n    document.getElementById(\"comment-box\").oninput = function (e) {\n      console.log(e.target.value);\n\n      if (e.target.value.length > 0) {\n        submit_comment.disabled = false;\n      } else {\n        submit_comment.disabled = true;\n      }\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.location.search != nextProps.location.search) {\n      this.new_page(nextProps);\n    }\n  }\n\n  new_page(props) {\n    const urlParams = new URLSearchParams(props.location.search);\n    const id = urlParams.get('id');\n    this.setState({\n      items: [],\n      comments: [],\n      video_id: id\n    });\n    fetch(\"/video?id=\" + id, {}).then(response => response.json()).then(data => {\n      console.log(data[\"manifest_url\"]);\n      this.setState({\n        \"manifest_url\": data[\"manifest_url\"] + \"?x-request=html\",\n        \"title\": data[\"title\"],\n        \"channel\": data[\"channel\"],\n        \"channel_url\": data[\"channel_url\"],\n        \"channel_icon_url\": data[\"channel_icon_url\"],\n        \"view_count\": data[\"view_count\"],\n        \"upload_date\": data[\"upload_date\"],\n        //\"subscriber_count\": abbreviate_number(data[\"subscriber_count\"]),\n        \"subscriber_count\": data[\"subscriber_count\"],\n        \"description\": data[\"description\"]\n      });\n      document.title = data[\"title\"];\n      var video = document.getElementById(\"videoPlayer\");\n\n      try {\n        this.state.player.reset();\n      } catch (error) {}\n\n      this.state.player = window.dashjs.MediaPlayer().create();\n      this.state.player.initialize(video, data[\"manifest_url\"], true);\n    });\n    fetch(\"/upnext_videos?start=0&num=10\", {}).then(response => response.json()).then(data => {\n      this.setState({\n        items: this.state.items.concat(data[\"videos\"])\n      });\n    });\n    fetch(\"/get_comments?start=0&num=10&video_id=\" + id, {}).then(response => response.json()).then(data => {\n      this.setState({\n        comments: this.state.comments.concat(data[\"data\"])\n      });\n    });\n  }\n\n  handleSubscribe() {}\n\n  handleCommentSubmit(event) {\n    event.preventDefault();\n    console.log(\"COMMENT SUBMIT\");\n    fetch(\"/submit_comment?video_id=\" + this.state.video_id + \"&content=\" + this.state.commentValue, {\n      method: 'POST'\n    }).then(response => response.json()).then(data => {\n      console.log(data);\n    });\n  }\n\n  handleCommentChange(event) {\n    this.setState({\n      commentValue: event.target.value\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      class: \"watch-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 16\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"left\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"video\", {\n      autoPlay: \"\",\n      id: \"videoPlayer\",\n      controls: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"under-video-area\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"video-description\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"description-top\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 25\n      }\n    }, this.state.title), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"views_date\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 25\n      }\n    }, this.state.view_count, \" views \\u2022 \", this.state.upload_date)), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"description-bottom\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"icon-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"#\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 29\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"channel-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      class: \"channel-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 29\n      }\n    }, this.state.channel), /*#__PURE__*/React.createElement(\"p\", {\n      class: \"subscriber-count\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 29\n      }\n    }, this.state.subscriber_count, \" subscribers\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"subscribe-button-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.handleSubscribe,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 29\n      }\n    }, \"SUBSCRIBE\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"description-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"pre\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 32\n      }\n    }, this.state.description))))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"comments-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"comment-options\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"comment-count\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 25\n      }\n    }, this.state.comments.length, \" \", this.state.comments.length == 1 ? 'Comment' : 'Comments'), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 25\n      }\n    }, \"Sort by:\"), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"select\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 33\n      }\n    }, \"Top\"), /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 33\n      }\n    }, \"New\")))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"comment-input-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleCommentSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"comment-box\",\n      name: \"comment\",\n      placeholder: \"Write a comment\",\n      onChange: this.handleCommentChange,\n      value: this.state.commentValue,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"submit-comment\",\n      type: \"submit\",\n      value: \"Submit\",\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 29\n      }\n    }, \"COMMENT\"))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"comments-list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 21\n      }\n    }, this.state.comments.map(val => /*#__PURE__*/React.createElement(VideoComment, {\n      username: val.username,\n      content: val.content,\n      post_time: val.post_time,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 29\n      }\n    })))))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"video-list-container\",\n      id: \"video-list-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(InfiniteScroll, {\n      dataLength: this.state.items.length,\n      next: this.fetchMoreData,\n      hasMore: true,\n      scrollableTarget: \"video-list-container\",\n      loader: /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 25\n        }\n      }, \"Loading...\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 17\n      }\n    }, this.state.items.map(val => /*#__PURE__*/React.createElement(RecommendedvideoPreview, {\n      title: val.title,\n      view_count: val.view_count,\n      upload_date: val.upload_date,\n      video_length: val.video_length,\n      static_url: val.static_url,\n      animated_url: val.animated_url,\n      channel: val.channel,\n      video_url: val.video_url,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 25\n      }\n    }))))));\n  }\n\n}\n\nfunction RecommendedvideoPreview(props) {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    class: \"video-item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"thumbnail-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(VideoPreview, {\n    video_length: props.video_length,\n    static_url: props.static_url,\n    animated_url: props.animated_url,\n    video_url: props.video_url,\n    channel: props.channel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 21\n    }\n  }, props.title), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"channel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 21\n    }\n  }, props.channel), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"views_date\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 21\n    }\n  }, props.view_count, \" views \\u2022 \", props.upload_date)));\n}\n\nfunction VideoComment(props) {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    class: \"video-comment\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"comment-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"comment-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"comment-username\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 13\n    }\n  }, props.username, props), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"comment-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 13\n    }\n  }, props.content)));\n}\n\nexport default Watch;","map":{"version":3,"sources":["/home/ubuntu/beamr/frontend/youtube-clone-frontend/src/Watch.js"],"names":["React","Component","InfiniteScroll","abbreviate_number","VideoPreview","Watch","constructor","props","fetchMoreData","fetch","then","response","json","data","setState","items","state","concat","urlParams","URLSearchParams","location","search","comments","hasMore","commentValue","video_id","get","new_page","handleCommentSubmit","bind","handleCommentChange","componentDidMount","submit_comment","document","getElementById","oninput","e","console","log","target","value","length","disabled","componentWillReceiveProps","nextProps","id","title","video","player","reset","error","window","dashjs","MediaPlayer","create","initialize","handleSubscribe","event","preventDefault","method","render","view_count","upload_date","channel","subscriber_count","description","map","val","username","content","post_time","video_length","static_url","animated_url","video_url","RecommendedvideoPreview","VideoComment"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport InfiniteScroll from 'react-infinite-scroll-component';\nimport './watch.scss'\nimport {abbreviate_number} from './helpers'\nimport VideoPreview from \"./VideoPreview\";\n\nclass Watch extends Component {\n\n    constructor(props) {\n        super(props);\n\n        const urlParams = new URLSearchParams(props.location.search);\n\n        this.state = {\n            'manifest_url': \"\",\n            'title': \"\",\n            'channel': \"\",\n            \"channel_url\": \"\",\n            \"channel_icon_url\": \"\",\n            \"view_count\": \"\",\n            \"upload_date\": \"\",\n            \"subscriber_count\": \"\",\n            \"description\": \"\",\n            items: [],\n            comments: [],\n            hasMore: false,\n            commentValue: \"\",\n            video_id: urlParams.get('id')\n        }\n\n        this.new_page(props);\n\n        this.handleCommentSubmit = this.handleCommentSubmit.bind(this);\n        this.handleCommentChange = this.handleCommentChange.bind(this);\n        \n    }\n\n    componentDidMount() {\n        var submit_comment = document.getElementById(\"submit-comment\");\n        document.getElementById(\"comment-box\").oninput = function(e) {\n            console.log(e.target.value);\n            if (e.target.value.length > 0) {\n                submit_comment.disabled = false;\n            } else {\n                submit_comment.disabled = true;\n            }\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if (this.props.location.search != nextProps.location.search) {\n            this.new_page(nextProps);\n        }\n    }\n\n    new_page(props) {\n        const urlParams = new URLSearchParams(props.location.search);\n        const id = urlParams.get('id');\n\n        this.setState({\n            items: [],\n            comments: [],\n            video_id: id\n        })\n\n        fetch(\"/video?id=\"+id, {\n        })\n        .then(response => response.json())\n        .then(data => {\n            console.log(data[\"manifest_url\"])\n            this.setState({\n                \"manifest_url\": data[\"manifest_url\"]+\"?x-request=html\",\n                \"title\": data[\"title\"],\n                \"channel\": data[\"channel\"],\n                \"channel_url\": data[\"channel_url\"],\n                \"channel_icon_url\": data[\"channel_icon_url\"],\n                \"view_count\": data[\"view_count\"],\n                \"upload_date\": data[\"upload_date\"],\n                //\"subscriber_count\": abbreviate_number(data[\"subscriber_count\"]),\n                \"subscriber_count\": data[\"subscriber_count\"],\n                \"description\": data[\"description\"]\n            })\n\n            document.title = data[\"title\"];\n\n            var video = document.getElementById(\"videoPlayer\");\n\n            try {\n                this.state.player.reset();\n            } catch (error) {\n                \n            }\n            this.state.player = window.dashjs.MediaPlayer().create();\n            this.state.player.initialize(video, data[\"manifest_url\"], true);\n        })\n\n        fetch(\"/upnext_videos?start=0&num=10\", {\n        })\n        .then(response => response.json())\n        .then(data => {\n            this.setState({\n                items: this.state.items.concat(data[\"videos\"])\n            })\n        })\n\n        fetch(\"/get_comments?start=0&num=10&video_id=\" + id, {})\n        .then(response => response.json())\n        .then(data => {\n            this.setState({\n                comments: this.state.comments.concat(data[\"data\"])\n            })\n        })\n    }\n\n\n    fetchMoreData = () => {\n        fetch(\"/upnext_videos?start=0&num=5\", {\n        })\n        .then(response => response.json())\n        .then(data => {\n            this.setState({\n                items: this.state.items.concat(data[\"videos\"])\n            })\n        })\n      };\n\n    handleSubscribe() {\n    }\n\n    handleCommentSubmit(event) {\n        event.preventDefault();\n        console.log(\"COMMENT SUBMIT\")\n        fetch(\"/submit_comment?video_id=\" + this.state.video_id + \"&content=\" + this.state.commentValue, {\n            method: 'POST'\n        })\n        .then(response => response.json())\n        .then(data => {\n            console.log(data)\n        })\n    }\n\n    handleCommentChange(event) {\n        this.setState({commentValue: event.target.value});\n    }\n\n    render() {\n        return <div class=\"watch-container\">\n        <div class=\"left\">\n            <video\n            autoPlay=\"\"\n            id=\"videoPlayer\"\n            controls></video>\n            <div class=\"under-video-area\">\n                <div class=\"video-description\">\n                    <div class=\"description-top\">\n                        <div class=\"title\">{this.state.title}</div>\n                        <div class=\"views_date\">{this.state.view_count} views • {this.state.upload_date}</div>\n                    </div>\n                    <div class=\"description-bottom\">\n                        <div class=\"icon-container\">\n                            <img src=\"#\"/>\n                        </div>\n                        <div class=\"channel-text\">\n                            <p class=\"channel-title\">{this.state.channel}</p>\n                            <p class=\"subscriber-count\">{this.state.subscriber_count} subscribers</p>\n                        </div>\n                        <div class=\"subscribe-button-container\">\n                            <button onClick={this.handleSubscribe}>SUBSCRIBE</button>\n                        </div>\n                        <div class=\"description-text\">\n                            <p><pre>{this.state.description}</pre></p>\n                        </div>\n                        \n                    </div>\n                </div>\n                <div class=\"comments-container\">\n                    <div class=\"comment-options\">\n                        <div class=\"comment-count\">\n                            {this.state.comments.length} {this.state.comments.length == 1 ? 'Comment' : 'Comments'}\n                        </div>\n                        <div>\n                            Sort by:\n                        </div>\n                        <div>\n                            <select>\n                                <option>Top</option>\n                                <option>New</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div class=\"comment-input-container\">\n                        <form onSubmit={this.handleCommentSubmit}>\n                            <input type=\"text\" id=\"comment-box\" name=\"comment\" placeholder=\"Write a comment\" onChange={this.handleCommentChange} value={this.state.commentValue} required/>\n                            <button id=\"submit-comment\" type=\"submit\" value=\"Submit\" disabled>COMMENT</button>\n                        </form>\n                    </div>\n                    <div class=\"comments-list\">\n                        {this.state.comments.map((val) => (\n                            <VideoComment \n                                username={val.username}\n                                content={val.content}\n                                post_time={val.post_time}\n                            />\n                        ))}\n                    </div>\n                </div>\n            </div>\n            \n        </div>\n        <div class=\"right\">\n            <div class=\"video-list-container\" id=\"video-list-container\">\n                <InfiniteScroll\n                dataLength={this.state.items.length}\n                next={this.fetchMoreData}\n                hasMore={true}\n                scrollableTarget=\"video-list-container\"\n                loader={<h4>Loading...</h4>}>\n                    {this.state.items.map((val) => (\n                        <RecommendedvideoPreview \n                            title={val.title} \n                            view_count={val.view_count} \n                            upload_date={val.upload_date}\n                            video_length={val.video_length}\n                            static_url={val.static_url}\n                            animated_url={val.animated_url}\n                            channel={val.channel}\n                            video_url={val.video_url}\n                        />\n                    ))}\n                </InfiniteScroll>\n            </div>\n        </div>\n    </div>\n    }\n}\n\nfunction RecommendedvideoPreview(props) {\n    return <div class=\"video-item\">\n                <div class=\"thumbnail-container\">\n                    <VideoPreview \n                        video_length={props.video_length}\n                        static_url={props.static_url}\n                        animated_url={props.animated_url}\n                        video_url={props.video_url}\n                        channel={props.channel}\n                    />\n                </div>\n\n                <div class=\"description\">\n                    <div class=\"title\">{props.title}</div>\n                    <div class=\"channel\">{props.channel}</div>\n                    <div class=\"views_date\">{props.view_count} views • {props.upload_date}</div>\n                </div>\n            </div>;\n}\n\nfunction VideoComment(props) {\n    return <div class=\"video-comment\">\n        <div class=\"comment-left\">\n            <img></img>\n        </div>\n        <div class=\"comment-right\">\n            <div class=\"comment-username\">\n                {props.username}\n                {props}\n            </div>\n            <div class=\"comment-content\">\n                {props.content}\n            </div>\n        </div>\n    </div>\n}\n\nexport default Watch;\n\n"]},"metadata":{},"sourceType":"module"}