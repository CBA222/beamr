{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/beamr/frontend/youtube-clone-frontend/src/Watch.js\";\nimport React, { Component } from \"react\";\nimport InfiniteScroll from 'react-infinite-scroll-component';\nimport './watch.scss';\nimport { abbreviate_number } from './helpers';\nimport VideoPreview from \"./VideoPreview\";\n\nclass Watch extends Component {\n  constructor(props) {\n    super(props);\n\n    this.fetchMoreData = () => {\n      fetch(\"/upnext_videos?start=0&num=5\", {}).then(response => response.json()).then(data => {\n        this.setState({\n          items: this.state.items.concat(data[\"videos\"])\n        });\n      });\n    };\n\n    this.state = {\n      'manifest_url': \"\",\n      'title': \"\",\n      'channel': \"\",\n      \"channel_url\": \"\",\n      \"channel_icon_url\": \"\",\n      \"view_count\": \"\",\n      \"upload_date\": \"\",\n      \"subscriber_count\": \"\",\n      \"description\": \"\",\n      items: [],\n      comments: [],\n      hasMore: false\n    };\n    this.new_page(props);\n    this.handleCommentSubmit = this.handleCommentSubmit.bind(this);\n  }\n\n  componentDidMount() {\n    var submit_comment = document.getElementById(\"submit-comment\");\n\n    document.getElementById(\"comment-box\").oninput = function (e) {\n      console.log(e.target.value);\n\n      if (e.target.value.length > 0) {\n        submit_comment.disabled = false;\n      } else {\n        submit_comment.disabled = true;\n      }\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.location.search != nextProps.location.search) {\n      this.new_page(nextProps);\n    }\n  }\n\n  new_page(props) {\n    const urlParams = new URLSearchParams(props.location.search);\n    const id = urlParams.get('id');\n    this.setState({\n      items: [],\n      comments: []\n    });\n    fetch(\"/video?id=\" + id, {}).then(response => response.json()).then(data => {\n      console.log(data[\"manifest_url\"]);\n      this.setState({\n        \"manifest_url\": data[\"manifest_url\"] + \"?x-request=html\",\n        \"title\": data[\"title\"],\n        \"channel\": data[\"channel\"],\n        \"channel_url\": data[\"channel_url\"],\n        \"channel_icon_url\": data[\"channel_icon_url\"],\n        \"view_count\": data[\"view_count\"],\n        \"upload_date\": data[\"upload_date\"],\n        //\"subscriber_count\": abbreviate_number(data[\"subscriber_count\"]),\n        \"subscriber_count\": data[\"subscriber_count\"],\n        \"description\": data[\"description\"]\n      });\n      var video = document.getElementById(\"videoPlayer\");\n\n      try {\n        this.state.player.reset();\n      } catch (error) {}\n\n      this.state.player = window.dashjs.MediaPlayer().create();\n      this.state.player.initialize(video, data[\"manifest_url\"], true);\n    });\n    fetch(\"/upnext_videos?start=0&num=10\", {}).then(response => response.json()).then(data => {\n      this.setState({\n        items: this.state.items.concat(data[\"videos\"])\n      });\n    });\n    fetch(\"/get_comments?start=0&num=10&video_id=\" + id, {}).then(response => response.json()).then(data => {\n      this.setState({\n        comments: this.state.comments.concat(data[\"data\"])\n      });\n    });\n  }\n\n  handleSubscribe() {}\n\n  handleCommentSubmit(event) {\n    alert(event.target.value);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      class: \"watch-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 16\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"left\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"video\", {\n      autoPlay: \"\",\n      id: \"videoPlayer\",\n      controls: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"under-video-area\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"video-description\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"description-top\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 25\n      }\n    }, this.state.title), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"views_date\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 25\n      }\n    }, this.state.view_count, \" views \\u2022 \", this.state.upload_date)), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"description-bottom\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"icon-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"#\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 29\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"channel-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      class: \"channel-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 29\n      }\n    }, this.state.channel), /*#__PURE__*/React.createElement(\"p\", {\n      class: \"subscriber-count\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 29\n      }\n    }, this.state.subscriber_count, \" subscribers\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"subscribe-button-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.handleSubscribe,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 29\n      }\n    }, \"SUBSCRIBE\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"description-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"pre\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 32\n      }\n    }, this.state.description))))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"comments-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"comment-options\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"comment-count\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 25\n      }\n    }, this.state.comments.length, \" Comments\"), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 25\n      }\n    }, \"Sort by:\"), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"select\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 33\n      }\n    }, \"Top\"), /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 33\n      }\n    }, \"New\")))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"comment-input-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleCommentSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"comment-box\",\n      name: \"comment\",\n      placeholder: \"Write a comment\",\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"submit-comment\",\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 29\n      }\n    }, \"COMMENT\"))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"comments-list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 21\n      }\n    }, this.state.comments.map(val => /*#__PURE__*/React.createElement(VideoComment, {\n      username: val.username,\n      content: val.content,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 29\n      }\n    })))))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"video-list-container\",\n      id: \"video-list-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(InfiniteScroll, {\n      dataLength: this.state.items.length,\n      next: this.fetchMoreData,\n      hasMore: true,\n      scrollableTarget: \"video-list-container\",\n      loader: /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 25\n        }\n      }, \"Loading...\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 17\n      }\n    }, this.state.items.map(val => /*#__PURE__*/React.createElement(RecommendedvideoPreview, {\n      title: val.title,\n      view_count: val.view_count,\n      upload_date: val.upload_date,\n      video_length: val.video_length,\n      static_url: val.static_url,\n      animated_url: val.animated_url,\n      channel: val.channel,\n      video_url: val.video_url,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 25\n      }\n    }))))));\n  }\n\n}\n\nfunction RecommendedvideoPreview(props) {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    class: \"video-item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"thumbnail-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(VideoPreview, {\n    video_length: props.video_length,\n    static_url: props.static_url,\n    animated_url: props.animated_url,\n    video_url: props.video_url,\n    channel: props.channel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 21\n    }\n  }, props.title), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"channel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 21\n    }\n  }, props.channel), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"views_date\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 21\n    }\n  }, props.view_count, \" views \\u2022 \", props.upload_date)));\n}\n\nfunction VideoComment(props) {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    class: \"video-comment\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"comment-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"comment-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"comment-username\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 13\n    }\n  }, props.username), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"comment-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 13\n    }\n  }, props.content)));\n}\n\nexport default Watch;","map":{"version":3,"sources":["/home/ubuntu/beamr/frontend/youtube-clone-frontend/src/Watch.js"],"names":["React","Component","InfiniteScroll","abbreviate_number","VideoPreview","Watch","constructor","props","fetchMoreData","fetch","then","response","json","data","setState","items","state","concat","comments","hasMore","new_page","handleCommentSubmit","bind","componentDidMount","submit_comment","document","getElementById","oninput","e","console","log","target","value","length","disabled","componentWillReceiveProps","nextProps","location","search","urlParams","URLSearchParams","id","get","video","player","reset","error","window","dashjs","MediaPlayer","create","initialize","handleSubscribe","event","alert","render","title","view_count","upload_date","channel","subscriber_count","description","map","val","username","content","video_length","static_url","animated_url","video_url","RecommendedvideoPreview","VideoComment"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport InfiniteScroll from 'react-infinite-scroll-component';\nimport './watch.scss'\nimport {abbreviate_number} from './helpers'\nimport VideoPreview from \"./VideoPreview\";\n\nclass Watch extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            'manifest_url': \"\",\n            'title': \"\",\n            'channel': \"\",\n            \"channel_url\": \"\",\n            \"channel_icon_url\": \"\",\n            \"view_count\": \"\",\n            \"upload_date\": \"\",\n            \"subscriber_count\": \"\",\n            \"description\": \"\",\n            items: [],\n            comments: [],\n            hasMore: false\n        }\n\n        this.new_page(props);\n\n        this.handleCommentSubmit = this.handleCommentSubmit.bind(this)\n        \n    }\n\n    componentDidMount() {\n        var submit_comment = document.getElementById(\"submit-comment\");\n        document.getElementById(\"comment-box\").oninput = function(e) {\n            console.log(e.target.value);\n            if (e.target.value.length > 0) {\n                submit_comment.disabled = false;\n            } else {\n                submit_comment.disabled = true;\n            }\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if (this.props.location.search != nextProps.location.search) {\n            this.new_page(nextProps);\n        }\n    }\n\n    new_page(props) {\n        const urlParams = new URLSearchParams(props.location.search);\n        const id = urlParams.get('id');\n\n        this.setState({\n            items: [],\n            comments: []\n        })\n\n        fetch(\"/video?id=\"+id, {\n        })\n        .then(response => response.json())\n        .then(data => {\n            console.log(data[\"manifest_url\"])\n            this.setState({\n                \"manifest_url\": data[\"manifest_url\"]+\"?x-request=html\",\n                \"title\": data[\"title\"],\n                \"channel\": data[\"channel\"],\n                \"channel_url\": data[\"channel_url\"],\n                \"channel_icon_url\": data[\"channel_icon_url\"],\n                \"view_count\": data[\"view_count\"],\n                \"upload_date\": data[\"upload_date\"],\n                //\"subscriber_count\": abbreviate_number(data[\"subscriber_count\"]),\n                \"subscriber_count\": data[\"subscriber_count\"],\n                \"description\": data[\"description\"]\n            })\n\n            var video = document.getElementById(\"videoPlayer\")\n\n            try {\n                this.state.player.reset();\n            } catch (error) {\n                \n            }\n            this.state.player = window.dashjs.MediaPlayer().create();\n            this.state.player.initialize(video, data[\"manifest_url\"], true);\n        })\n\n        fetch(\"/upnext_videos?start=0&num=10\", {\n        })\n        .then(response => response.json())\n        .then(data => {\n            this.setState({\n                items: this.state.items.concat(data[\"videos\"])\n            })\n        })\n\n        fetch(\"/get_comments?start=0&num=10&video_id=\" + id, {})\n        .then(response => response.json())\n        .then(data => {\n            this.setState({\n                comments: this.state.comments.concat(data[\"data\"])\n            })\n        })\n    }\n\n\n    fetchMoreData = () => {\n        fetch(\"/upnext_videos?start=0&num=5\", {\n        })\n        .then(response => response.json())\n        .then(data => {\n            this.setState({\n                items: this.state.items.concat(data[\"videos\"])\n            })\n        })\n      };\n\n    handleSubscribe() {\n    }\n\n    handleCommentSubmit(event) {\n        alert(event.target.value)\n    }\n\n    render() {\n        return <div class=\"watch-container\">\n        <div class=\"left\">\n            <video\n            autoPlay=\"\"\n            id=\"videoPlayer\"\n            controls></video>\n            <div class=\"under-video-area\">\n                <div class=\"video-description\">\n                    <div class=\"description-top\">\n                        <div class=\"title\">{this.state.title}</div>\n                        <div class=\"views_date\">{this.state.view_count} views • {this.state.upload_date}</div>\n                    </div>\n                    <div class=\"description-bottom\">\n                        <div class=\"icon-container\">\n                            <img src=\"#\"/>\n                        </div>\n                        <div class=\"channel-text\">\n                            <p class=\"channel-title\">{this.state.channel}</p>\n                            <p class=\"subscriber-count\">{this.state.subscriber_count} subscribers</p>\n                        </div>\n                        <div class=\"subscribe-button-container\">\n                            <button onClick={this.handleSubscribe}>SUBSCRIBE</button>\n                        </div>\n                        <div class=\"description-text\">\n                            <p><pre>{this.state.description}</pre></p>\n                        </div>\n                        \n                    </div>\n                </div>\n                <div class=\"comments-container\">\n                    <div class=\"comment-options\">\n                        <div class=\"comment-count\">{this.state.comments.length} Comments</div>\n                        <div>\n                            Sort by:\n                        </div>\n                        <div>\n                            <select>\n                                <option>Top</option>\n                                <option>New</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div class=\"comment-input-container\">\n                        <form onSubmit={this.handleCommentSubmit}>\n                            <input type=\"text\" id=\"comment-box\" name=\"comment\" placeholder=\"Write a comment\" required/>\n                            <button id=\"submit-comment\" disabled>COMMENT</button>\n                        </form>\n                    </div>\n                    <div class=\"comments-list\">\n                        {this.state.comments.map((val) => (\n                            <VideoComment \n                                username={val.username}\n                                content={val.content}\n                            />\n                        ))}\n                    </div>\n                </div>\n            </div>\n            \n        </div>\n        <div class=\"right\">\n            <div class=\"video-list-container\" id=\"video-list-container\">\n                <InfiniteScroll\n                dataLength={this.state.items.length}\n                next={this.fetchMoreData}\n                hasMore={true}\n                scrollableTarget=\"video-list-container\"\n                loader={<h4>Loading...</h4>}>\n                    {this.state.items.map((val) => (\n                        <RecommendedvideoPreview \n                            title={val.title} \n                            view_count={val.view_count} \n                            upload_date={val.upload_date}\n                            video_length={val.video_length}\n                            static_url={val.static_url}\n                            animated_url={val.animated_url}\n                            channel={val.channel}\n                            video_url={val.video_url}\n                        />\n                    ))}\n                </InfiniteScroll>\n            </div>\n        </div>\n    </div>\n    }\n}\n\nfunction RecommendedvideoPreview(props) {\n    return <div class=\"video-item\">\n                <div class=\"thumbnail-container\">\n                    <VideoPreview \n                        video_length={props.video_length}\n                        static_url={props.static_url}\n                        animated_url={props.animated_url}\n                        video_url={props.video_url}\n                        channel={props.channel}\n                    />\n                </div>\n\n                <div class=\"description\">\n                    <div class=\"title\">{props.title}</div>\n                    <div class=\"channel\">{props.channel}</div>\n                    <div class=\"views_date\">{props.view_count} views • {props.upload_date}</div>\n                </div>\n            </div>;\n}\n\nfunction VideoComment(props) {\n    return <div class=\"video-comment\">\n        <div class=\"comment-left\">\n            <img></img>\n        </div>\n        <div class=\"comment-right\">\n            <div class=\"comment-username\">\n                {props.username}\n            </div>\n            <div class=\"comment-content\">\n                {props.content}\n            </div>\n        </div>\n    </div>\n}\n\nexport default Watch;\n\n"]},"metadata":{},"sourceType":"module"}